name: Sync GitHub to Gitee
on:
  push:
    branches: [ main, master, dev ]  # å¯æ ¹æ®ä½ çš„å®é™…åˆ†æ”¯è°ƒæ•´
    tags: ['*']                      # åŒæ­¥æ‰€æœ‰æ ‡ç­¾ï¼ˆå…³è” Releaseï¼‰
  release:
    types: [published, edited]       # å‘å¸ƒ/ç¼–è¾‘ Release éƒ½è§¦å‘
  workflow_dispatch:                 # æ‰‹åŠ¨è§¦å‘æŒ‰é’®ï¼Œæ–¹ä¾¿è¡¥åŒæ­¥

jobs:
  sync-to-gitee:
    runs-on: ubuntu-latest
    timeout-minutes: 10              # è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œé¿å…å¡ä½
    steps:
      - name: Checkout full repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # æ‹‰å–æ‰€æœ‰æäº¤å†å²å’Œæ ‡ç­¾ï¼Œå¿…é¡»é…ç½®

      - name: Sync code to Gitee
        uses: wearerequired/git-mirror-action@master
        env:
          # ç”¨ GIT_TOKEN åš HTTPS è®¤è¯ï¼ˆæ ¸å¿ƒä¿®å¤ï¼‰
          GIT_TOKEN: ${{ secrets.GITEE_TOKEN }}
        with:
          source-repo: "https://github.com/${{ github.repository }}.git"
          # HTTPS è®¤è¯æ ¼å¼ï¼šç”¨æˆ·å:ä»¤ç‰Œ@ä»“åº“åœ°å€
          destination-repo: "https://${{ secrets.GITEE_USERNAME }}:${{ secrets.GITEE_TOKEN }}@gitee.com/${{ secrets.GITEE_USERNAME }}/${{ github.event.repository.name }}.git"

      - name: Sync verification
        run: |
          # è¾“å‡ºåŒæ­¥ç»“æœï¼Œæ–¹ä¾¿æ’æŸ¥
          echo "âœ… åŒæ­¥å®Œæˆï¼"
          echo "ğŸ”— Gitee ä»“åº“åœ°å€ï¼šhttps://gitee.com/${{ secrets.GITEE_USERNAME }}/${{ github.event.repository.name }}"
          echo "ğŸ”– æœ¬æ¬¡åŒæ­¥çš„åˆ†æ”¯/æ ‡ç­¾ï¼š${{ github.ref }}"
